# 	 This file is used to plot figures for the software Bayescan in R.

#    This program, BayeScan, aims at detecting genetics markers under selection,
#	 based on allele frequency differences between population. 
#    Copyright (C) 2010  Matthieu Foll
#
#    This program is free software: you can redistribute it and/or modify
#    it under the terms of the GNU General Public License as published by
#    the Free Software Foundation, either version 3 of the License, or
#    (at your option) any later version.
#
#    This program is distributed in the hope that it will be useful,
#    but WITHOUT ANY WARRANTY; without even the implied warranty of
#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#    GNU General Public License for more details.

#    You should have received a copy of the GNU General Public License
#    along with this program.  If not, see <http://www.gnu.org/licenses/>.

# Arguments:
# - file is the name of your file ex: "output_fst.txt"
# - the q-value threshold corresponding to the target False Discovery Rate (FDR)
# - size is the size of the points and text labels for outliers
# - pos is the distance between the points and the labels 
# - highlight is a optional list of marker indices to display in red.
# - name_highlighted allows to write the indices of highlighted markers instead of using a point like the other markers
# - add_text adds the indices of the outlier markers

# Output:
# This function returns different parameters in a list
# - outliers: the list of outliers
# - nb_outliers: the number of outliers

# Typical usage: 
# - load this file into R (file/source R code)
# - in R, go to the directory where "output_fst.txt" is (file/change current dir)
# - at the R prompt, type 
#> plot_bayescan("output_fst.txt",0,FDR=0.05)
# if you save the output in a variable, you can recall the different results:
# results<-plot_bayescan("output_fst.txt",0,FDR=0.05)
# results$outliers
# results$nb_outliers

#
# plotting posterior distribution is very easy in R with the output of BayeScan:
# first load the output file *.sel produced by BayeScan
# > mydata=read.table("bi.sel",colClasses="numeric")
# choose the parameter you want to plot by setting for example:
# parameter="Fst1"
# then this line will make the plot for:
# > plot(density(mydata[[parameter]]),xlab=parameter,main=paste(parameter,"posterior distribution"))
# you can plot population specific Fst coefficient by setting
# parameter="Fst1"
# if you have non-codominant data you can plot posterior for Fis coefficients in each population:
# parameter="Fis1"
# if you test for selection, you can plot the posterior for alpha coefficient for selection:
# parameter="alpha1"
# you also have access to the likelihood with:
# parameter="logL"
# if you have the package "boa" installed, you can very easily obtain Highest Probability 
# Density Interval (HPDI) for your parameter of interest (example for the 95% interval):
# > boa.hpd(mydata[[parameter]],0.05)

plot_bayescan<-function(res,FDR=0.05,size=1,pos=0.35,highlight=NULL,name_highlighted=F,add_text=T)
{
if (is.character(res))
  res=read.table(res)

colfstat=5
colq=colfstat-2

highlight_rows=which(is.element(as.numeric(row.names(res)),highlight))
non_highlight_rows=setdiff(1:nrow(res),highlight_rows)

outliers=as.integer(row.names(res[res[,colq]<=FDR,]))

ok_outliers=TRUE
if (sum(res[,colq]<=FDR)==0)
	ok_outliers=FALSE;

res[res[,colq]<=0.0001,colq]=0.0001

# plot
plot(log10(res[,colq]),res[,colfstat],xlim=rev(range(log10(res[,colq]))),xlab="log10(q value)",ylab=names(res[colfstat]),type="n")
points(log10(res[non_highlight_rows,colq]),res[non_highlight_rows,colfstat],pch=19,cex=size)

if (name_highlighted) {
 	if (length(highlight_rows)>0) {
 		text(log10(res[highlight_rows,colq]),res[highlight_rows,colfstat],row.names(res[highlight_rows,]),col="red",cex=size*1.2,font=2)
 	}
}
else {
	points(log10(res[highlight_rows,colq]),res[highlight_rows,colfstat],col="red",pch=19,cex=size)
	# add names of loci over p and vertical line
	if (ok_outliers & add_text) {
		text(log10(res[res[,colq]<=FDR,][,colq])+pos*(round(runif(nrow(res[res[,colq]<=FDR,]),1,2))*2-3),res[res[,colq]<=FDR,][,colfstat],row.names(res[res[,colq]<=FDR,]),cex=size)
	}
}
lines(c(log10(FDR),log10(FDR)),c(-1,1),lwd=2)

return(list("outliers"=outliers,"nb_outliers"=length(outliers)))
}

setwd(".../bayescan")
results0.05 <- plot_bayescan("bayescan_run_fst.txt",0,FDR=0.05)
results0.05$outliers
# [1]   185   186   189   228   317   324   362   407   419   421   429   431   432   433   437
# [16]   444   445   485   486   487   488   489   507   511   512   513   623   655   661   662
# [31]   664   717   718   720   721   722   723   725   727   730   733   752   791   880   894
# [46]   900   901   928   929   930   931   935   936   938   942  1024  1089  1102  1113  1230
# [61]  1231  1250  1314  1315  1351  1353  1383  1385  1412  1418  1426  1466  1467  1469  1638
# [76]  1652  1653  1654  1655  1656  1661  1705  1935  1937  1955  1961  1969  1971  1973  1975
# [91]  1994  2037  2059  2080  2184  2265  2267  2272  2276  2282  2283  2284  2285  2286  2287
# [106]  2288  2306  2370  2371  2372  2376  2377  2378  2381  2387  2388  2394  2402  2502  2503
# [121]  2590  2591  2593  2594  2732  2744  2786  2789  2790  2795  2796  2797  2798  2866  2964
# [136]  2965  2966  2967  2968  2971  2978  2979  3028  3067  3068  3082  3178  3214  3256  3278
# [151]  3340  3347  3350  3383  3417  3418  3419  3420  3422  3426  3606  3608  4021  4048  4049
# [166]  4191  4192  4195  4207  4209  4211  4212  4226  4240  4242  4253  4392  4395  4413  4415
# [181]  4440  4461  4546  4567  4634  4635  4717  4813  4992  5106  5170  5171  5172  5176  5177
# [196]  5179  5181  5182  5185  5346  5349  5393  5398  5404  5491  5493  5494  5496  5568  5573
# [211]  5663  5711  5712  5713  5926  6011  6014  6016  6018  6030  6055  6078  6080  6130  6146
# [226]  6147  6150  6153  6161  6218  6219  6220  6221  6391  6466  6547  6548  6550  6551  6552
# [241]  6553  6554  6567  6585  6587  6588  6723  6783  6890  6891  7107  7113  7128  7135  7136
# [256]  7372  7373  7400  7530  7551  7715  7830  8006  8007  8009  8013  8017  8018  8058  8151
# [271]  8187  8190  8191  8193  8195  8199  8356  8357  8365  8371  8393  8394  8395  8421  8425
# [286]  8663  8664  8685  8689  8721  8841  8913  8971  8973  8975  8977  8978  8982  8985  8986
# [301]  8987  8988  8989  8990  8994  8996  8998  8999  9104  9269  9275  9277  9279  9282  9283
# [316]  9297  9298  9417  9422  9423  9431  9509  9526  9527  9632  9633  9798  9811  9815  9818
# [331]  9856  9952 10178 10208 10212 10224 10226 10553 10554 10556 10557 10558 10559 10603 10604
# [346] 10646 10690 10709 10710 10714 10715 10716 10719 10862 10908 10968 11108 11122 11127 11129
# [361] 11180 11266 11275 11278 11426 11455 11486 11548 11605 11674 11729 11736 11821 11828 11839
# [376] 11841 11844 11945 11963 12032 12151 12223 12224 12225 12297 12508 12564 12640 12651 12705
# [391] 12919 12952 13045 13057 13125 13126 13131 13133 13160 13181 13183 13184 13185 13189 13191
# [406] 13192 13194 13196 13210 13211 13215 13322 13326 13328 13331 13332 13335 13398 13401 13512
# [421] 13522 13568 13570 13571 13586 13587 13588 13590 13637 13640 13745 13897 13905 13908 13993
# [436] 14051 14101 14143 14200 14254 14276 14284 14285 14286 14322 14403 14404 14405 14406 14407
# [451] 14408 14411 14413 14443 14469 14480 14822 14830 14888 14916 14917 14922 14924 14925 15010
# [466] 15066 15110 15111 15112 15119 15122 15302 15364 15367 15526 15616 15669 15692 15728 15729
# [481] 15730 15731 15733 15734 15736 15737 15738 15739 15740 15741 15742 15746 15764 15765 15785
# [496] 15790 15791 15793 15862 15897 15898 16000 16002 16007 16038 16117 16189 16193 16197 16198
# [511] 16203 16204 16342 16350 16458 16523 16526 16528 16567 16607 16668 16672 16673 16674 16676
# [526] 16679 16875 17056 17074 17110 17111 17112 17113 17118 17143 17144 17145 17147 17148 17149
# [541] 17150 17153 17154 17155 17156 17158 17159 17160 17161 17164 17167 17177 17199 17200 17201
# [556] 17202 17230 17299 17300 17301 17302 17362 17364 17377 17410 17485 17490 17491 17492 17493
# [571] 17496 17535 17542 17543 17579 17580 17581 17582 17583 17584 17708 17819 18086 18087 18196
# [586] 18209 18292 18372 18373 18374 18375 18376 18377 18378 18379 18381 18408 18413 18415 18447
# [601] 18448 18449 18458 18570 18736 18999 19048 19051 19193 19196 19197 19199 19200 19204 19207
# [616] 19220 19237 19275 19281 19282 19283 19285 19286 19288 19289 19290 19338 19548 19705 19737
# [631] 19739 19746 19790 19925 19926 19927 20160 20605 20758 20875 21106 21181 21222 21347 21349
# [646] 21351 21352 21354 21355 21364 21370 21371 21373 21416 21417 21468 21535 21537 21552 21554
# [661] 21555 21556 21557 21655 21850 21996 22065 22283 22314 22316 22317 22321 22322 22366 22394
# [676] 22399 22400 22590 22628 22632 22635 22684 22773 22814 22853 22870 22873 22979 23063 23064
# [691] 23355 23357 23358 23360 23361 23362 23365 23366 23367 23369 23497 23500 23586 23620 23621
# [706] 23626 23627 23628 23629 23630 23631 23634 23635 23637 23649 23682 23781 23869 23870 23927
# [721] 23959 24107 24113 24166 24180 24198 24199 24212 24213 24214 24215 24247 24269 24431 24433
# [736] 24439 24522 24525 24532 24572 24580 24633 24693 24701 24716 24718 24810 24816 24825 24835
# [751] 24990 24993 25053 25167 25356 25422 25559 25598 25635 25636 25637 25638 25639 25640 25645
# [766] 25672 25836 25884 25885 25886 25887 25958 25970 26160 26164 26256 26257 26387 26439 26639
# [781] 26831 26846 26984 26985 27032 27033 27089 27172 27202 27238 27355 27394 27559 27562 27606
# [796] 27608 27661 27822 27823 27965 28121 28122 28123 28125 28293 28358 28454 28455 28456 28457
# [811] 28459 28475 28476 28478 28613 28923 29216 29241 29250 29390 29418 29539 29540 29593 29594
# [826] 29629 29630 29668 29669 29688 29745 29746 29747 29766 29778 29856 29940 29997 30033 30034
# [841] 30095 30114 30150 30392 30393 30414 30527 30529 30531 30560 30569 30570 30613 30639 30640
# [856] 30780 30876 30882 30885 30916 30919 30921 30927 30940 30977 31016 31017 31019 31045 31052
# [871] 31053 31054 31055 31056 31058 31059 31060 31189 31196 31222 31223 31289 31299 31304 31309
# [886] 31317 31318 31319 31365 31394 31408 31595 31599 31600 31601 31733 31734 31739 31743 31744
# [901] 31747 31802 31873 32004 32005 32011 32077 32079 32082 32091 32098 32100 32105 32111 32113
# [916] 32289 32401 32426 32427 32441 32460 32461 32570 32574 32575 32588 32598 32599 32621 32622
# [931] 32652 32739 32759 32760 32761 32763 32764 32765 32798 32802 32817 32985 33032 33049 33064
# [946] 33075 33330 33365 33376 33489 33505 33519 33520 33717 33720 33762 33765 33780 33781 33812
# [961] 33814 33840 33860 33902 33903 34059 34066 34067 34068 34069 34070 34072 34091 34264 34279
# [976] 34296 34539 34540 34541 34791 34976 35002 35060 35061 35096 35098 35127 35144 35146 35165
# [991] 35168 35253 35256 35295 35335 35441 35608 35609 35610 35612
# [ reached getOption("max.print") -- omitted 9959 entries ]
results0.05$nb_outliers
# [1] 10959

results0.01 <- plot_bayescan("bayescan_run_fst.txt",0,FDR=0.01)
results0.01$outliers
# [1]   185   186   189   228   317   324   362   407   419   421   429   437   444   445   485
# [16]   486   487   488   489   507   511   512   513   623   661   662   664   717   718   720
# [31]   721   722   723   725   727   730   733   791   880   894   901   928   929   930   931
# [46]   935   938   942  1024  1102  1113  1230  1231  1351  1353  1383  1385  1412  1467  1469
# [61]  1638  1652  1653  1654  1655  1656  1705  1935  1955  1961  1969  1971  1973  1975  1994
# [76]  2265  2267  2272  2276  2282  2283  2284  2285  2286  2287  2288  2306  2370  2371  2372
# [91]  2376  2377  2378  2381  2387  2388  2394  2402  2502  2503  2591  2593  2594  2732  2744
# [106]  2786  2789  2790  2795  2796  2797  2798  2866  2967  2968  2971  2978  3067  3068  3082
# [121]  3178  3214  3278  3340  3350  3417  3418  3419  3420  3422  3426  3606  3608  4048  4049
# [136]  4191  4195  4209  4212  4226  4240  4242  4253  4392  4395  4413  4415  4440  4546  4567
# [151]  4634  4635  4717  4813  4992  5170  5171  5172  5176  5177  5179  5181  5182  5185  5349
# [166]  5393  5398  5493  5494  5496  5568  5573  5663  5711  5926  6011  6014  6016  6018  6030
# [181]  6078  6080  6146  6147  6150  6153  6161  6218  6219  6220  6221  6391  6547  6548  6550
# [196]  6551  6552  6553  6554  6567  6585  6587  6588  6723  6783  6890  6891  7107  7113  7128
# [211]  7135  7136  7373  7551  7715  7830  8006  8007  8009  8013  8017  8018  8151  8187  8191
# [226]  8193  8195  8199  8356  8357  8365  8371  8393  8394  8395  8421  8425  8663  8664  8689
# [241]  8841  8913  8971  8975  8977  8978  8982  8985  8986  8987  8988  8990  8994  8996  8999
# [256]  9104  9269  9275  9277  9279  9282  9283  9297  9298  9417  9431  9526  9527  9632  9633
# [271]  9798  9811  9818  9856  9952 10178 10208 10212 10224 10553 10554 10556 10557 10558 10559
# [286] 10603 10604 10709 10714 10715 10716 10719 10908 10968 11108 11122 11127 11129 11180 11266
# [301] 11278 11486 11548 11674 11736 11828 11839 11844 11963 12032 12151 12224 12225 12297 12508
# [316] 12640 12705 13045 13057 13125 13126 13133 13160 13181 13183 13184 13185 13189 13191 13196
# [331] 13210 13211 13331 13335 13522 13570 13586 13587 13588 13590 13637 13745 13897 13905 13993
# [346] 14101 14200 14254 14276 14284 14285 14286 14403 14404 14405 14406 14407 14408 14411 14413
# [361] 14469 14480 14822 14888 14916 14917 14922 14924 14925 15066 15110 15111 15112 15119 15122
# [376] 15302 15364 15367 15616 15669 15692 15728 15729 15730 15731 15733 15734 15736 15737 15738
# [391] 15739 15740 15742 15746 15785 15790 15791 15862 15897 16002 16007 16038 16117 16189 16193
# [406] 16197 16204 16350 16458 16523 16526 16528 16567 16607 16668 16672 16673 16674 16676 16875
# [421] 17074 17110 17111 17112 17113 17143 17144 17145 17147 17148 17149 17150 17154 17156 17158
# [436] 17159 17160 17161 17167 17177 17199 17200 17201 17202 17230 17299 17300 17301 17302 17362
# [451] 17364 17490 17493 17496 17542 17543 17579 17580 17581 17583 17584 17708 18086 18087 18209
# [466] 18292 18372 18373 18374 18375 18376 18377 18378 18379 18381 18408 18413 18415 18447 18448
# [481] 18458 18570 18736 18999 19048 19051 19197 19199 19200 19204 19207 19237 19275 19281 19282
# [496] 19283 19285 19286 19288 19289 19290 19338 19548 19705 19737 19746 19790 19925 19926 19927
# [511] 20160 20758 20875 21106 21181 21222 21347 21349 21351 21352 21354 21355 21364 21370 21371
# [526] 21373 21416 21417 21468 21537 21552 21554 21555 21556 21557 21655 21850 21996 22283 22314
# [541] 22316 22317 22321 22322 22366 22394 22399 22400 22590 22628 22632 22635 22773 22814 22853
# [556] 22870 22873 23063 23064 23355 23357 23358 23360 23361 23362 23365 23366 23367 23369 23497
# [571] 23500 23586 23620 23621 23626 23627 23628 23629 23630 23635 23637 23682 23869 23927 24166
# [586] 24180 24198 24199 24212 24213 24214 24215 24247 24269 24431 24433 24439 24522 24525 24580
# [601] 24633 24693 24701 24716 24718 24810 24816 24825 24835 24990 24993 25167 25356 25559 25635
# [616] 25636 25637 25638 25639 25640 25645 25672 25836 25884 25885 25886 25887 25958 25970 26164
# [631] 26256 26257 26387 26439 26639 26831 26984 26985 27032 27033 27172 27202 27238 27394 27559
# [646] 27562 27606 27608 27822 27823 28121 28122 28123 28293 28358 28454 28455 28456 28457 28459
# [661] 28475 28476 28478 29216 29250 29390 29418 29539 29540 29593 29594 29629 29630 29668 29669
# [676] 29745 29746 29747 29997 30033 30034 30095 30114 30150 30392 30393 30529 30531 30560 30569
# [691] 30570 30613 30639 30640 30876 30882 30885 30916 30919 30921 30940 30977 31016 31017 31052
# [706] 31053 31054 31055 31056 31058 31059 31060 31196 31222 31289 31299 31304 31309 31318 31319
# [721] 31365 31394 31408 31599 31600 31601 31733 31734 31739 31743 31744 31747 31802 32004 32005
# [736] 32011 32077 32079 32082 32098 32100 32105 32111 32289 32401 32426 32427 32441 32460 32461
# [751] 32574 32575 32598 32599 32621 32622 32739 32761 32763 32802 32817 32985 33049 33330 33365
# [766] 33376 33489 33519 33520 33717 33762 33765 33781 33812 33840 33860 33902 33903 34059 34066
# [781] 34067 34068 34069 34070 34072 34091 34296 35002 35060 35061 35127 35144 35165 35168 35253
# [796] 35256 35295 35335 35441 35608 35609 35610 35612 35613 35618 35619 35625 35627 35628 35629
# [811] 35758 35768 36029 36030 36064 36092 36096 36097 36098 36099 36100 36104 36150 36210 36211
# [826] 36246 36247 36414 36509 36681 36753 36840 36856 36858 36861 36985 36994 37025 37059 37189
# [841] 37242 37246 37261 37281 37283 37353 37354 37356 37418 37423 37425 37556 37566 37567 37738
# [856] 37761 37932 37956 37959 38046 38049 38051 38053 38054 38063 38064 38065 38066 38070 38074
# [871] 38075 38076 38250 38292 38346 38350 38382 38451 38482 38483 38486 38488 38572 38674 38700
# [886] 38701 38702 38707 38845 38846 38847 38848 38849 38850 38851 38852 38853 39049 39050 39051
# [901] 39141 39215 39303 39360 39363 39364 39440 39442 39612 39678 39711 39714 39802 39803 39804
# [916] 39805 39806 39807 39808 39809 39810 39811 39836 39846 39918 40027 40036 40333 40398 40508
# [931] 40644 40645 40646 40647 40649 40831 40833 40938 41062 41092 41094 41123 41309 41407 41500
# [946] 41502 41622 41625 41627 41660 41665 41669 41792 41793 41794 41809 41812 41814 41863 42133
# [961] 42177 42179 42364 42413 42414 42480 42553 42555 42621 42622 42623 42624 42625 42630 42848
# [976] 42957 42974 43058 43071 43072 43076 43077 43079 43080 43081 43082 43083 43097 43426 43441
# [991] 43442 43445 43446 43447 43450 43451 43452 43453 43454 43455
# [ reached getOption("max.print") -- omitted 7693 entries ]
results0.01$nb_outliers
# [1] 8693

#export outlier SNP list for FDR=0.01
lapply(results0.01$outliers, write, "bayescan_outliers_FDR_0.01.txt", append=TRUE)

results0.001 <- plot_bayescan("bayescan_run_fst.txt",0,FDR=0.001)
results0.001$outliers
# [1]   185   186   189   228   317   324   407   419   429   437   444   445   486   487   488
# [16]   511   512   513   664   717   718   720   721   722   723   725   727   880   894   901
# [31]   928   929   930   931   935  1024  1113  1230  1351  1353  1383  1385  1412  1469  1638
# [46]  1652  1653  1654  1655  1656  1955  1961  1969  1971  1973  1975  1994  2265  2267  2282
# [61]  2283  2284  2285  2286  2287  2288  2306  2370  2371  2372  2376  2377  2378  2387  2388
# [76]  2394  2402  2502  2503  2593  2594  2744  2786  2789  2790  2795  2796  2797  2798  2967
# [91]  2968  2978  3178  3214  3340  3350  3417  3418  3419  3420  3422  3426  3606  4048  4049
# [106]  4191  4195  4209  4212  4226  4242  4253  4395  4546  4992  5170  5172  5176  5179  5181
# [121]  5182  5349  5494  5496  5568  5663  5711  5926  6011  6014  6016  6018  6030  6146  6147
# [136]  6153  6218  6219  6220  6221  6391  6547  6548  6550  6551  6552  6553  6554  6567  6783
# [151]  7107  7113  7373  7715  8006  8007  8009  8013  8017  8018  8187  8193  8199  8371  8393
# [166]  8394  8395  8664  8689  8841  8913  8975  8977  8978  8982  8985  8986  8987  8988  8990
# [181]  8994  8996  8999  9104  9269  9277  9279  9282  9283  9297  9298  9431  9526  9527  9632
# [196]  9633  9798  9811  9856  9952 10178 10208 10212 10224 10553 10554 10556 10557 10558 10559
# [211] 10603 10604 10709 10714 10715 10716 10719 10908 10968 11108 11122 11127 11129 11180 11266
# [226] 11278 11674 11736 11828 11844 11963 12032 12297 12508 12705 13045 13133 13183 13184 13185
# [241] 13189 13191 13211 13335 13522 13570 13586 13587 13588 13590 13637 13905 14101 14200 14254
# [256] 14276 14284 14285 14286 14403 14404 14405 14406 14469 14916 14922 14924 14925 15110 15111
# [271] 15112 15119 15302 15367 15616 15728 15729 15730 15731 15733 15734 15736 15737 15738 15739
# [286] 15740 15785 15790 15791 15862 15897 16007 16038 16117 16193 16197 16204 16350 16458 16523
# [301] 16526 16528 16668 16673 16676 17074 17110 17111 17145 17147 17148 17149 17150 17154 17156
# [316] 17158 17161 17177 17200 17201 17300 17301 17362 17364 17490 17493 17496 17542 17543 17579
# [331] 17580 17581 17584 17708 18086 18372 18373 18374 18375 18376 18377 18379 18381 18408 18415
# [346] 18570 18999 19048 19051 19204 19207 19281 19282 19283 19285 19286 19288 19289 19290 19737
# [361] 19790 19925 19926 19927 20160 20875 21222 21347 21349 21351 21352 21354 21364 21370 21371
# [376] 21373 21416 21417 21537 21850 22283 22314 22316 22317 22321 22322 22366 22394 22399 22400
# [391] 22590 22628 22632 22635 22814 22853 22873 23063 23064 23355 23357 23358 23360 23361 23362
# [406] 23365 23366 23367 23369 23497 23500 23586 23620 23626 23627 23628 23629 23630 23682 23927
# [421] 24166 24199 24212 24213 24214 24215 24247 24431 24433 24522 24525 24693 24701 24716 24718
# [436] 24810 24816 24835 24990 24993 25356 25559 25635 25636 25637 25638 25639 25672 25836 25884
# [451] 25885 25886 25887 25958 26387 26639 26831 26984 26985 27033 27202 27238 27562 27606 27608
# [466] 27822 27823 28121 28123 28293 28358 28454 28455 28456 28457 28459 28475 28476 28478 29390
# [481] 29418 29539 29594 29630 29669 29746 29747 29997 30034 30150 30392 30529 30531 30560 30569
# [496] 30570 30639 30640 30876 30885 30916 30921 30940 31016 31017 31052 31053 31054 31055 31056
# [511] 31058 31059 31060 31196 31222 31289 31299 31309 31319 31408 31599 31601 31733 31734 31739
# [526] 31743 31744 31747 32004 32005 32011 32079 32082 32098 32100 32105 32111 32289 32426 32460
# [541] 32461 32574 32598 32599 32739 32761 32763 32817 32985 33049 33330 33376 33762 33781 33812
# [556] 33840 33902 33903 34066 34067 34068 34069 34070 34072 34091 34296 35144 35165 35168 35253
# [571] 35256 35295 35441 35608 35618 35619 35625 35627 35628 35629 35758 36029 36030 36064 36092
# [586] 36096 36097 36098 36099 36100 36104 36150 36246 36247 36509 36681 36856 36858 36861 36994
# [601] 37025 37059 37242 37246 37281 37283 37353 37354 37738 37761 37932 37959 38051 38053 38054
# [616] 38063 38064 38065 38066 38070 38075 38076 38250 38346 38382 38451 38482 38486 38488 38674
# [631] 38700 38701 38702 38707 38845 38846 38850 38852 39049 39050 39051 39141 39215 39364 39440
# [646] 39442 39612 39711 39714 39802 39803 39804 39805 39806 39807 39808 39809 39810 39811 39836
# [661] 39846 39918 40027 40036 40508 40644 40645 40646 40647 40649 41062 41092 41094 41123 41309
# [676] 41500 41502 41622 41627 41660 41665 41669 41793 41794 41809 41814 41863 42133 42177 42179
# [691] 42364 42413 42480 42553 42555 42621 42624 42625 42848 42957 42974 43071 43072 43076 43077
# [706] 43079 43080 43081 43082 43083 43426 43446 43450 43451 43452 43455 43458 43460 43503 43595
# [721] 43598 43606 43612 43615 43617 43647 43673 43674 43680 43727 44120 44276 44346 44633 44714
# [736] 44771 44776 44778 44779 44781 44784 44786 44801 44846 44847 44849 44850 44851 44852 44947
# [751] 44955 45033 45037 45038 45039 45304 45306 45309 45312 45315 45362 45364 45365 45366 45368
# [766] 45437 45635 45639 45644 45647 45669 45677 45873 45875 45876 45877 46092 46103 46104 46107
# [781] 46132 46536 46599 46623 46629 46630 46631 46632 46633 46635 46636 46638 46639 46869 46870
# [796] 46873 46920 46923 46934 46935 47006 47142 47149 47380 47399 47424 47499 47611 47612 47613
# [811] 47616 47831 47999 48000 48001 48004 48005 48011 48012 48192 48306 48307 48389 48390 48392
# [826] 48393 48394 48398 48425 48464 48506 48563 48567 48568 48570 48571 48572 48573 48781 48782
# [841] 48784 48786 48909 48949 48950 49130 49133 49138 49194 49285 49286 49400 49414 49416 49421
# [856] 49424 49569 49572 49573 49574 49575 49724 49733 49764 49905 49943 50002 50007 50158 50285
# [871] 50286 50287 50421 50601 50800 50886 50887 50935 51046 51109 51127 51134 51226 51268 51363
# [886] 51369 51554 51730 52349 52351 52471 52474 52475 52476 52478 52481 52513 52514 52515 52520
# [901] 52521 52531 52720 52752 52789 52801 53205 53250 53304 53307 53308 53331 53333 53340 53453
# [916] 53454 53763 53768 53803 53804 53805 53807 53871 53986 54036 54281 54283 54319 54320 54321
# [931] 54353 54359 54487 54585 54586 54588 54590 54642 54644 54645 54647 54649 54650 54651 54657
# [946] 54659 54671 54726 54727 54729 54730 54731 54733 54734 54739 54741 54908 54940 55016 55055
# [961] 55057 55083 55084 55086 55301 55348 55349 55423 55424 55594 55617 55631 55635 55636 55716
# [976] 55717 56022 56305 56448 56562 56741 56745 56746 56775 56780 56782 56783 56785 56786 56789
# [991] 56797 56807 56924 57033 57034 57037 57039 57125 57126 57129
# [ reached getOption("max.print") -- omitted 5404 entries ]
results0.001$nb_outliers
# [1] 6404

results0.0001 <- plot_bayescan("bayescan_run_fst.txt",0,FDR=0.0001)
results0.0001$outliers
# [1]   185   186   189   228   317   419   429   437   444   445   487   488   511   512   513
# [16]   664   717   718   721   723   725   727   894   928   929   930   931  1024  1113  1230
# [31]  1353  1385  1469  1652  1653  1654  1655  1656  1955  1961  1971  1973  1975  1994  2265
# [46]  2267  2282  2283  2284  2285  2287  2288  2306  2371  2372  2376  2377  2378  2387  2388
# [61]  2394  2402  2502  2503  2593  2594  2786  2789  2790  2795  2796  2798  2978  3340  3417
# [76]  3418  3419  3420  3422  3426  3606  4049  4191  4195  4242  4395  4546  4992  5170  5172
# [91]  5179  5181  5182  5349  5494  5496  5663  5711  6011  6014  6018  6030  6146  6147  6153
# [106]  6218  6219  6220  6221  6391  6547  6548  6550  6551  6552  6553  6554  6783  7107  7373
# [121]  7715  8006  8007  8018  8187  8193  8199  8371  8393  8394  8664  8689  8841  8975  8977
# [136]  8978  8982  8985  8986  8987  8988  8990  8994  8996  8999  9104  9277  9279  9282  9283
# [151]  9298  9431  9527  9632  9633  9856  9952 10208 10212 10553 10554 10556 10557 10558 10559
# [166] 10603 10604 10709 10714 10715 10716 10908 10968 11108 11127 11129 11180 11278 11674 11736
# [181] 11828 11844 11963 12032 12297 12508 12705 13045 13183 13184 13185 13189 13191 13522 13587
# [196] 13590 13637 14101 14200 14254 14276 14284 14285 14286 14403 14405 14406 14469 14922 14924
# [211] 15110 15112 15119 15302 15367 15728 15729 15730 15731 15733 15734 15736 15737 15738 15739
# [226] 15785 15790 15791 15897 16038 16117 16193 16197 16458 16523 16668 16673 17074 17110 17145
# [241] 17147 17148 17149 17150 17158 17161 17300 17301 17362 17364 17493 17496 17543 17579 17580
# [256] 17581 17584 17708 18086 18372 18373 18374 18375 18376 18377 18381 18408 18415 18570 18999
# [271] 19048 19204 19281 19282 19283 19285 19286 19288 19289 19290 19737 19790 20160 20875 21347
# [286] 21349 21351 21352 21364 21370 21371 21373 21850 22283 22316 22317 22321 22322 22394 22399
# [301] 22400 22628 22814 22873 23063 23064 23355 23357 23358 23360 23361 23362 23365 23366 23367
# [316] 23369 23500 23586 23620 23626 23627 23628 23629 24199 24215 24247 24433 24522 24525 24693
# [331] 24718 24810 24835 24993 25559 25636 25637 25639 25672 25836 25884 25885 25886 25887 26387
# [346] 26831 26984 26985 27033 27202 27238 27562 27606 27608 27822 27823 28123 28293 28358 28454
# [361] 28455 28457 28459 28475 28476 29390 29418 29539 29594 29630 29669 29997 30392 30531 30569
# [376] 30570 30640 30876 30885 30916 30921 31017 31052 31053 31054 31055 31056 31058 31059 31060
# [391] 31196 31222 31309 31319 31408 31601 31733 31734 31743 31744 31747 32004 32005 32079 32082
# [406] 32098 32111 32289 32426 32460 32461 32574 32739 32761 32763 33049 33330 33376 33762 33781
# [421] 33903 34066 34067 34068 34069 34072 34091 34296 35144 35165 35168 35253 35256 35295 35441
# [436] 35608 35619 35625 35627 35629 35758 36029 36030 36064 36092 36096 36098 36099 36100 36104
# [451] 36150 36509 36681 36856 36858 36994 37059 37246 37281 37283 37738 37761 37932 38051 38053
# [466] 38054 38063 38064 38065 38066 38070 38250 38346 38382 38451 38486 38674 38700 38701 38702
# [481] 38707 38846 38850 38852 39049 39050 39051 39141 39215 39364 39440 39442 39612 39711 39714
# [496] 39802 39803 39804 39805 39806 39807 39808 39809 39810 39811 39836 39846 39918 40036 40644
# [511] 40645 40646 40647 40649 41092 41094 41123 41309 41500 41622 41627 41660 41665 41669 41793
# [526] 41794 41809 41863 42133 42177 42179 42480 42621 42624 42625 42957 42974 43071 43072 43076
# [541] 43079 43080 43081 43082 43083 43426 43598 43606 43615 43617 43673 43674 43680 43727 44276
# [556] 44346 44633 44714 44771 44779 44781 44846 44847 44850 44851 44852 44947 45033 45037 45038
# [571] 45039 45304 45306 45309 45312 45315 45362 45364 45365 45366 45368 45437 45635 45639 45644
# [586] 45647 45669 45677 45873 45875 46104 46132 46536 46599 46629 46630 46631 46632 46633 46635
# [601] 46639 46870 46934 47142 47149 47380 47424 47499 47611 47612 47613 47616 47831 47999 48000
# [616] 48001 48004 48005 48011 48012 48306 48389 48392 48393 48394 48398 48425 48464 48563 48568
# [631] 48570 48571 48572 48573 48781 48784 48786 49133 49138 49194 49285 49286 49400 49414 49421
# [646] 49569 49572 49573 49574 49575 49724 49733 49764 49905 49943 50007 50158 50285 50286 50287
# [661] 50800 50886 51109 51268 51363 51369 51554 51730 52351 52471 52474 52475 52481 52513 52514
# [676] 52515 52520 52521 52531 52720 52801 53250 53304 53307 53308 53331 53333 53340 53453 53454
# [691] 53803 53804 53805 53807 53871 53986 54036 54281 54283 54319 54321 54353 54359 54487 54585
# [706] 54586 54588 54590 54644 54645 54650 54651 54657 54659 54671 54726 54727 54729 54730 54731
# [721] 54733 54734 54739 54908 54940 55055 55057 55083 55084 55086 55301 55348 55349 55424 55617
# [736] 55716 55717 56305 56448 56562 56745 56746 56775 56780 56782 56783 56785 56786 56789 56797
# [751] 56807 57033 57034 57037 57125 57126 57129 57130 57132 57134 57149 57183 57422 57543 57559
# [766] 57663 57677 57726 57730 57734 57737 57897 57898 57899 58036 58074 58099 58320 58322 58418
# [781] 58453 58460 58490 58495 58511 58515 58593 58790 58882 58902 58903 58906 59029 59071 59273
# [796] 59280 59478 59480 59519 59525 59526 59527 59531 59532 59539 59540 59545 59648 59723 59726
# [811] 59727 59930 60086 60089 60183 60279 60599 60605 60779 60783 60784 60789 60790 60839 61042
# [826] 61102 61293 61294 61295 61449 61893 61929 61930 61934 61941 61942 61943 61944 62028 62050
# [841] 62115 62116 62236 62237 62238 62240 62241 62243 62244 62246 62248 62249 62252 62253 62337
# [856] 62343 62421 62662 62966 63062 63065 63102 63236 63393 63394 63927 64099 64162 64164 64677
# [871] 64682 64747 64857 64858 64859 64862 64991 65337 65374 65687 65746 65766 65767 65951 65977
# [886] 65978 65979 65981 66065 66072 66077 66082 66274 66542 66620 67028 67256 67475 67535 67728
# [901] 67729 67730 67857 68048 68226 68227 68229 68230 68233 68685 68686 68687 68691 68870 68982
# [916] 69000 69002 69009 69010 69144 69642 69643 69780 69781 69961 70037 70040 70041 70125 70476
# [931] 70477 70478 70492 70499 70617 70620 70623 70624 70687 70982 70988 70989 70992 70993 70996
# [946] 70997 71002 71045 71047 71049 71068 71070 71084 71100 71457 71458 71461 71462 71463 71469
# [961] 71495 71586 71588 71622 71623 71624 71625 71652 71899 71900 71901 71903 72236 72238 72239
# [976] 72240 72241 72243 72260 72433 72443 72622 72633 72657 72850 72854 72876 72882 72903 72966
# [991] 72967 72972 72978 73055 73240 73360 73408 73560 73562 73709
# [ reached getOption("max.print") -- omitted 3921 entries ]
results0.0001$nb_outliers
# [1] 4921

results0.00001 <- plot_bayescan("bayescan_run_fst.txt",0,FDR=0.00001)
# Error in text.default(log10(res[res[, colq] <= FDR, ][, colq]) + pos * :
#                         zero-length 'labels' specified
##### Can't go below FDR=0.0001
##### Do not understand results - why are so many outliers being detected?
##### Also don't understand the plots.
