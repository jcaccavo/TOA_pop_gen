#!/bin/bash

### 5x – area 48
#1st: estimate saf file per population - takes around 20-30 minutes
#angsd -GL 1 -out /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_area48 -ref /srv/public/users/jcaccavo/00_genome2021/D.mawsoni.genome.fasta -anc /srv/public/users/jcaccavo/00_genome2021/D.mawsoni.genome.fasta -nThreads 40 -dosaf 1 -bam /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/x_scripts/bam_filelists/5x_TOA_only_area48_bam.filelist
#2nd: estimate folded SFS - takes around 50 minutes
#realSFS /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_area48.saf.idx -fold 1 -P 40 > /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_area48_folded.sfs
#3rd: estimate nucleotide diversity () per site - takes around 40 minutes
#realSFS saf2theta /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_area48.saf.idx -sfs /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_area48_folded.sfs -outname /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_area48
#4th: estimate Tajima's D and Watterson Theta with a sliding window (window size 50kb, step size 10kb) - takes around 25 minutes
#thetaStat do_stat /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_area48.thetas.idx -win 50000 -step 10000 -outnames /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_area48.theta.thetasWindow.gz
#thetaStat print /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_area48.thetas.idx > /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_area48.thetas
#awk '{ print $2, $3, $4, $9 }' /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_area48.theta.thetasWindow.gz.pestPG > /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_area48_sumstats
### 5x – area 58
#1st: estimate saf file per population - takes around 20-30 minutes
#angsd -GL 1 -out /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_area58 -ref /srv/public/users/jcaccavo/00_genome2021/D.mawsoni.genome.fasta -anc /srv/public/users/jcaccavo/00_genome2021/D.mawsoni.genome.fasta -nThreads 40 -dosaf 1 -bam /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/x_scripts/bam_filelists/5x_TOA_only_area58_bam.filelist
#2nd: estimate folded SFS - takes around 50 minutes
#realSFS /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_area58.saf.idx -fold 1 -P 40 > /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_area58_folded.sfs
#3rd: estimate nucleotide diversity () per site - takes around 40 minutes
#realSFS saf2theta /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_area58.saf.idx -sfs /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_area58_folded.sfs -outname /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_area58
#4th: estimate Tajima's D and Watterson Theta with a sliding window (window size 50kb, step size 10kb) - takes around 25 minutes
#thetaStat do_stat /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_area58.thetas.idx -win 50000 -step 10000 -outnames /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_area58.theta.thetasWindow.gz
#thetaStat print /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_area58.thetas.idx > /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_area58.thetas
#awk '{ print $2, $3, $4, $9 }' /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_area58.theta.thetasWindow.gz.pestPG > /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_area58_sumstats
### 5x – area 88
#1st: estimate saf file per population - takes around 20-30 minutes
#angsd -GL 1 -out /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_area88 -ref /srv/public/users/jcaccavo/00_genome2021/D.mawsoni.genome.fasta -anc /srv/public/users/jcaccavo/00_genome2021/D.mawsoni.genome.fasta -nThreads 40 -dosaf 1 -bam /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/x_scripts/bam_filelists/5x_TOA_only_area88_bam.filelist
#2nd: estimate folded SFS - takes around 50 minutes
#realSFS /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_area88.saf.idx -fold 1 -P 40 > /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_area88_folded.sfs
#3rd: estimate nucleotide diversity () per site - takes around 40 minutes
#realSFS saf2theta /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_area88.saf.idx -sfs /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_area88_folded.sfs -outname /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_area88
#4th: estimate Tajima's D and Watterson Theta with a sliding window (window size 50kb, step size 10kb) - takes around 25 minutes
#thetaStat do_stat /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_area88.thetas.idx -win 50000 -step 10000 -outnames /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_area88.theta.thetasWindow.gz
#thetaStat print /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_area88.thetas.idx > /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_area88.thetas
#awk '{ print $2, $3, $4, $9 }' /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_area88.theta.thetasWindow.gz.pestPG > /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_area88_sumstats
### 5x – cohort pre2000
#1st: estimate saf file per population - takes around 20-30 minutes
#angsd -GL 1 -out /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_cohort_pre2000 -ref /srv/public/users/jcaccavo/00_genome2021/D.mawsoni.genome.fasta -anc /srv/public/users/jcaccavo/00_genome2021/D.mawsoni.genome.fasta -nThreads 40 -dosaf 1 -bam /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/x_scripts/bam_filelists/5x_TOA_only_cohort_pre2000_bam.filelist
#2nd: estimate folded SFS - takes around 50 minutes
#realSFS /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_cohort_pre2000.saf.idx -fold 1 -P 40 > /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_cohort_pre2000_folded.sfs
#3rd: estimate nucleotide diversity () per site - takes around 40 minutes
#realSFS saf2theta /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_cohort_pre2000.saf.idx -sfs /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_cohort_pre2000_folded.sfs -outname /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_cohort_pre2000
#4th: estimate Tajima's D and Watterson Theta with a sliding window (window size 50kb, step size 10kb) - takes around 25 minutes
#thetaStat do_stat /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_cohort_pre2000.thetas.idx -win 50000 -step 10000 -outnames /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_cohort_pre2000.theta.thetasWindow.gz
#thetaStat print /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_cohort_pre2000.thetas.idx > /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_cohort_pre2000.thetas
#awk '{ print $2, $3, $4, $9 }' /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_cohort_pre2000.theta.thetasWindow.gz.pestPG > /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_cohort_pre2000_sumstats
### 5x – cohort post2000
#1st: estimate saf file per population - takes around 20-30 minutes
#angsd -GL 1 -out /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_cohort_post2000 -ref /srv/public/users/jcaccavo/00_genome2021/D.mawsoni.genome.fasta -anc /srv/public/users/jcaccavo/00_genome2021/D.mawsoni.genome.fasta -nThreads 40 -dosaf 1 -bam /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/x_scripts/bam_filelists/5x_TOA_only_cohort_post2000_bam.filelist
#2nd: estimate folded SFS - takes around 50 minutes
#realSFS /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_cohort_post2000.saf.idx -fold 1 -P 40 > /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_cohort_post2000_folded.sfs
#3rd: estimate nucleotide diversity () per site - takes around 40 minutes
#realSFS saf2theta /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_cohort_post2000.saf.idx -sfs /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_cohort_post2000_folded.sfs -outname /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_cohort_post2000
#4th: estimate Tajima's D and Watterson Theta with a sliding window (window size 50kb, step size 10kb) - takes around 25 minutes
#thetaStat do_stat /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_cohort_post2000.thetas.idx -win 50000 -step 10000 -outnames /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_cohort_post2000.theta.thetasWindow.gz
#thetaStat print /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_cohort_post2000.thetas.idx > /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_cohort_post2000.thetas
#awk '{ print $2, $3, $4, $9 }' /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_cohort_post2000.theta.thetasWindow.gz.pestPG > /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_cohort_post2000_sumstats
### 5x – pre2000 area 48
#1st: estimate saf file per population - takes around 20-30 minutes
angsd -GL 1 -out /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_pre2000_area48 -ref /srv/public/users/jcaccavo/00_genome2021/D.mawsoni.genome.fasta -anc /srv/public/users/jcaccavo/00_genome2021/D.mawsoni.genome.fasta -nThreads 40 -dosaf 1 -bam /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/x_scripts/bam_filelists/5x_TOA_only_pre2000_area48_bam.filelist
#2nd: estimate folded SFS - takes around 50 minutes
realSFS /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_pre2000_area48.saf.idx -fold 1 -P 40 > /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_pre2000_area48_folded.sfs
#3rd: estimate nucleotide diversity () per site - takes around 40 minutes
realSFS saf2theta /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_pre2000_area48.saf.idx -sfs /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_pre2000_area48_folded.sfs -outname /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_pre2000_area48
#4th: estimate Tajima's D and Watterson Theta with a sliding window (window size 50kb, step size 10kb) - takes around 25 minutes
thetaStat do_stat /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_pre2000_area48.thetas.idx -win 50000 -step 10000 -outnames /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_pre2000_area48.theta.thetasWindow.gz
thetaStat print /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_pre2000_area48.thetas.idx > /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_pre2000_area48.thetas
awk '{ print $2, $3, $4, $9 }' /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_pre2000_area48.theta.thetasWindow.gz.pestPG > /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_pre2000_area48_sumstats
### 5x – pre2000 area 58
#1st: estimate saf file per population - takes around 20-30 minutes
angsd -GL 1 -out /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_pre2000_area58 -ref /srv/public/users/jcaccavo/00_genome2021/D.mawsoni.genome.fasta -anc /srv/public/users/jcaccavo/00_genome2021/D.mawsoni.genome.fasta -nThreads 40 -dosaf 1 -bam /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/x_scripts/bam_filelists/5x_TOA_only_pre2000_area58_bam.filelist
#2nd: estimate folded SFS - takes around 50 minutes
realSFS /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_pre2000_area58.saf.idx -fold 1 -P 40 > /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_pre2000_area58_folded.sfs
#3rd: estimate nucleotide diversity () per site - takes around 40 minutes
realSFS saf2theta /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_pre2000_area58.saf.idx -sfs /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_pre2000_area58_folded.sfs -outname /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_pre2000_area58
#4th: estimate Tajima's D and Watterson Theta with a sliding window (window size 50kb, step size 10kb) - takes around 25 minutes
thetaStat do_stat /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_pre2000_area58.thetas.idx -win 50000 -step 10000 -outnames /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_pre2000_area58.theta.thetasWindow.gz
thetaStat print /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_pre2000_area58.thetas.idx > /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_pre2000_area58.thetas
awk '{ print $2, $3, $4, $9 }' /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_pre2000_area58.theta.thetasWindow.gz.pestPG > /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_pre2000_area58_sumstats
### 5x – pre2000 area 88
#1st: estimate saf file per population - takes around 20-30 minutes
angsd -GL 1 -out /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_pre2000_area88 -ref /srv/public/users/jcaccavo/00_genome2021/D.mawsoni.genome.fasta -anc /srv/public/users/jcaccavo/00_genome2021/D.mawsoni.genome.fasta -nThreads 40 -dosaf 1 -bam /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/x_scripts/bam_filelists/5x_TOA_only_pre2000_area88_bam.filelist
#2nd: estimate folded SFS - takes around 50 minutes
realSFS /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_pre2000_area88.saf.idx -fold 1 -P 40 > /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_pre2000_area88_folded.sfs
#3rd: estimate nucleotide diversity () per site - takes around 40 minutes
realSFS saf2theta /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_pre2000_area88.saf.idx -sfs /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_pre2000_area88_folded.sfs -outname /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_pre2000_area88
#4th: estimate Tajima's D and Watterson Theta with a sliding window (window size 50kb, step size 10kb) - takes around 25 minutes
thetaStat do_stat /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_pre2000_area88.thetas.idx -win 50000 -step 10000 -outnames /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_pre2000_area88.theta.thetasWindow.gz
thetaStat print /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_pre2000_area88.thetas.idx > /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_pre2000_area88.thetas
awk '{ print $2, $3, $4, $9 }' /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_pre2000_area88.theta.thetasWindow.gz.pestPG > /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_pre2000_area88_sumstats
### 5x – post2000 area 48
#1st: estimate saf file per population - takes around 20-30 minutes
angsd -GL 1 -out /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_post2000_area48 -ref /srv/public/users/jcaccavo/00_genome2021/D.mawsoni.genome.fasta -anc /srv/public/users/jcaccavo/00_genome2021/D.mawsoni.genome.fasta -nThreads 40 -dosaf 1 -bam /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/x_scripts/bam_filelists/5x_TOA_only_post2000_area48_bam.filelist
#2nd: estimate folded SFS - takes around 50 minutes
realSFS /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_post2000_area48.saf.idx -fold 1 -P 40 > /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_post2000_area48_folded.sfs
#3rd: estimate nucleotide diversity () per site - takes around 40 minutes
realSFS saf2theta /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_post2000_area48.saf.idx -sfs /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_post2000_area48_folded.sfs -outname /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_post2000_area48
#4th: estimate Tajima's D and Watterson Theta with a sliding window (window size 50kb, step size 10kb) - takes around 25 minutes
thetaStat do_stat /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_post2000_area48.thetas.idx -win 50000 -step 10000 -outnames /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_post2000_area48.theta.thetasWindow.gz
thetaStat print /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_post2000_area48.thetas.idx > /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_post2000_area48.thetas
awk '{ print $2, $3, $4, $9 }' /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_post2000_area48.theta.thetasWindow.gz.pestPG > /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_post2000_area48_sumstats
### 5x – post2000 area 58
#1st: estimate saf file per population - takes around 20-30 minutes
angsd -GL 1 -out /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_post2000_area58 -ref /srv/public/users/jcaccavo/00_genome2021/D.mawsoni.genome.fasta -anc /srv/public/users/jcaccavo/00_genome2021/D.mawsoni.genome.fasta -nThreads 40 -dosaf 1 -bam /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/x_scripts/bam_filelists/5x_TOA_only_post2000_area58_bam.filelist
#2nd: estimate folded SFS - takes around 50 minutes
realSFS /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_post2000_area58.saf.idx -fold 1 -P 40 > /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_post2000_area58_folded.sfs
#3rd: estimate nucleotide diversity () per site - takes around 40 minutes
realSFS saf2theta /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_post2000_area58.saf.idx -sfs /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_post2000_area58_folded.sfs -outname /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_post2000_area58
#4th: estimate Tajima's D and Watterson Theta with a sliding window (window size 50kb, step size 10kb) - takes around 25 minutes
thetaStat do_stat /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_post2000_area58.thetas.idx -win 50000 -step 10000 -outnames /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_post2000_area58.theta.thetasWindow.gz
thetaStat print /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_post2000_area58.thetas.idx > /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_post2000_area58.thetas
awk '{ print $2, $3, $4, $9 }' /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_post2000_area58.theta.thetasWindow.gz.pestPG > /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_post2000_area58_sumstats
### 5x – post2000 area 88
#1st: estimate saf file per population - takes around 20-30 minutes
angsd -GL 1 -out /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_post2000_area88 -ref /srv/public/users/jcaccavo/00_genome2021/D.mawsoni.genome.fasta -anc /srv/public/users/jcaccavo/00_genome2021/D.mawsoni.genome.fasta -nThreads 40 -dosaf 1 -bam /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/x_scripts/bam_filelists/5x_TOA_only_post2000_area88_bam.filelist
#2nd: estimate folded SFS - takes around 50 minutes
realSFS /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_post2000_area88.saf.idx -fold 1 -P 40 > /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_post2000_area88_folded.sfs
#3rd: estimate nucleotide diversity () per site - takes around 40 minutes
realSFS saf2theta /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_post2000_area88.saf.idx -sfs /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_post2000_area88_folded.sfs -outname /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_post2000_area88
#4th: estimate Tajima's D and Watterson Theta with a sliding window (window size 50kb, step size 10kb) - takes around 25 minutes
thetaStat do_stat /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_post2000_area88.thetas.idx -win 50000 -step 10000 -outnames /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_post2000_area88.theta.thetasWindow.gz
thetaStat print /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_post2000_area88.thetas.idx > /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_post2000_area88.thetas
awk '{ print $2, $3, $4, $9 }' /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_post2000_area88.theta.thetasWindow.gz.pestPG > /srv/public/users/jcaccavo/11_CCGA_full_seq/02_NovaSeq/02_WG/14_downsampling/04_no_repeats_depthfilter/02_5x/5X_post2000_area88_sumstats
